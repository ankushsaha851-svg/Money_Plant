<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Earn Pro Max</title>
    <script src="https://pl28729308.effectivegatecpm.com/fa/b0/cc/fab0cc32b8a64517204fb06dbc69d7e6.js"></script>
    <script src='//libtl.com/sdk.js' data-zone='10610418' data-sdk='show_10610418'></script>
    <script src="https://sad.adsgram.ai/js/sad.min.js"></script> 
    <style>
        :root {
            --bg-dark: #12141d;
            --card-dark: #1c1f2e;
            --accent-purple: #9d50bb;
            --accent-green: #00f260;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-dark);
            color: #ffffff;
            margin: 0;
            padding: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .app-container { width: 100%; max-width: 420px; }

        /* --- LOCK OVERLAY --- */
        #global-lock-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-dark); z-index: 1000; flex-direction: column;
            align-items: center; justify-content: center; text-align: center;
        }

        /* --- HEADER --- */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; width: 100%;}
        .coin-display { background: rgba(255, 255, 255, 0.05); padding: 10px 18px; border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.1); text-align: right; }
        .balance-main { color: #ffd700; font-weight: bold; font-size: 20px; }
        
        .withdraw-bar { width: 100%; display: flex; justify-content: flex-end; margin-bottom: 20px; gap: 10px; }
        .btn-withdraw { 
            background: linear-gradient(90deg, #ff8c00, #ff4500); border: none; 
            color: white; padding: 8px 15px; border-radius: 12px; font-weight: bold; 
            cursor: pointer; box-shadow: 0 4px 15px rgba(255, 69, 0, 0.3);
        }
        .btn-history {
            background: #2a2e3f; border: 1px solid #444;
            color: white; padding: 8px 15px; border-radius: 12px; font-weight: bold; 
            cursor: pointer;
        }

        /* --- DAILY PROGRESS --- */
        .daily-card { background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%); padding: 20px; border-radius: 24px; margin-bottom: 25px; width: 100%; box-sizing: border-box;}
        .checkin-grid { display: flex; gap: 10px; margin-bottom: 15px; justify-content: space-between; }
        .day-circle { width: 35px; height: 35px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; }

        /* --- TASK SECTION TITLE --- */
        .section-title { 
            margin-bottom: 15px; 
            font-weight: 800; 
            font-size: 18px; 
            letter-spacing: 1px;
            background: linear-gradient(to right, #00f260, #0575E6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 10px rgba(0, 242, 96, 0.2);
        }

        /* --- TASK GRID --- */
        .task-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 100%;}
        .task-card { padding: 25px 10px; border-radius: 22px; text-align: center; cursor: pointer; border: 1px solid rgba(255,255,255,0.05); position: relative; transition: opacity 0.3s; }
        .task-card.disabled { opacity: 0.5; cursor: not-allowed; pointer-events: none; }
        
        .task-limit { 
            position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.3); 
            padding: 2px 8px; border-radius: 10px; font-size: 10px; font-weight: bold; color: #fff;
        }

        .blue-gradient { background: linear-gradient(135deg, #2193b0, #6dd5ed); }
        .purple-gradient { background: linear-gradient(135deg, #8e2de2, #4a00e0); }
        .green-gradient { background: linear-gradient(135deg, #11998e, #38ef7d); }
        .orange-gradient { background: linear-gradient(135deg, #ff9966, #ff5e62); }

        /* --- OVERLAYS --- */
        .overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-dark); z-index: 100; padding: 20px; box-sizing: border-box;
            text-align: center; overflow-y: auto;
        }

        .game-content { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 90%; }

        /* --- WITHDRAW METHODS --- */
        .method-card {
            background: #1c1f2e; border-radius: 15px; padding: 15px; margin-bottom: 12px;
            display: flex; align-items: center; cursor: pointer; border: 1px solid rgba(255,255,255,0.1);
            transition: 0.3s;
        }
        .method-card:hover { border-color: #ff8c00; }
        .method-img { width: 50px; height: 50px; border-radius: 8px; margin-right: 15px; object-fit: contain; background: white; padding: 5px; }
        .method-info { text-align: left; }
        .method-info b { display: block; font-size: 16px; }
        .method-info span { font-size: 12px; opacity: 0.6; }

        /* --- HISTORY LIST --- */
        .history-item {
            background: #1c1f2e; border-radius: 12px; padding: 15px; margin-bottom: 10px;
            display: flex; justify-content: space-between; align-items: center; text-align: left;
            border: 1px solid rgba(255,255,255,0.05);
        }

        /* --- WITHDRAW AMOUNT SELECTOR --- */
        .amount-selector { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; }
        .amount-btn { 
            background: #2a2e3f; border: 1px solid #444; color: white; padding: 10px; 
            border-radius: 10px; cursor: pointer; font-size: 11px; flex: 1;
        }
        .amount-btn.active { border-color: #ff8c00; background: rgba(255, 140, 0, 0.2); }

        /* --- ELEMENTS --- */
        #wheel-wrapper { position: relative; width: 280px; height: 280px; margin: 20px 0; }
        #wheel-container { width: 100%; height: 100%; transition: transform 4s cubic-bezier(0.1, 0, 0.2, 1); }
        .wheel-svg { width: 100%; height: 100%; transform: rotate(-22.5deg); }
        .pointer { position: absolute; top: -15px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 30px solid #ffd700; z-index: 10; }

        .scratch-area { width: 280px; height: 150px; background: #555; border-radius: 15px; display: flex; align-items: center; justify-content: center; cursor: pointer; border: 3px dashed #888; }
        .action-btn { background: #f7971e; border: none; color: white; padding: 15px 40px; border-radius: 12px; font-weight: bold; cursor: pointer; width: 100%; max-width: 300px; }
        input[type="number"], .input-text { width: 80%; padding: 15px; border-radius: 12px; border: none; font-size: 16px; text-align: center; margin-bottom: 20px; background: #1c1f2e; color: white; border: 1px solid #444; }
        
        #timer-banner { background: rgba(255, 82, 82, 0.2); color: #ff5252; padding: 12px; border-radius: 12px; margin-bottom: 15px; display: none; font-weight: bold; text-align: center; width: 100%; box-sizing: border-box;}
    </style>
</head>
<body>

<div id="global-lock-overlay">
    <span style="font-size: 60px;">‚è≥</span>
    <h2 style="color: #ff8c00;">Tasks Completed!</h2>
    <p style="opacity: 0.8; padding: 0 20px;">You've finished everything. Come back after:</p>
    <h1 id="lock-timer-display" style="font-size: 40px; margin: 10px 0;">05:00:00</h1>
    <p style="font-size: 12px; opacity: 0.5;">Everything will reset automatically.</p>
</div>

<div class="app-container">
    <div class="header">
        <div class="user-info" style="display: flex; align-items: center;">
            <div class="avatar" style="width:40px; height:40px; background:var(--accent-purple); border-radius:50%; display:flex; align-items:center; justify-content:center;">
                <svg viewBox="0 0 24 24" width="24" height="24" fill="white">
                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
            </div>
            <div style="margin-left:10px;"><b>Welcome Sir!</b></div>
        </div>
        <div class="coin-display">
            <div class="balance-main">üí∞ <span id="coins">0</span></div>
            <div style="font-size:12px; opacity:0.6;">‚âà ‚Çπ<span id="rupees">0.00</span></div>
        </div>
    </div>

    <div class="withdraw-bar">
        <button class="btn-history" onclick="openHistory()">HISTORY</button>
        <button class="btn-withdraw" onclick="openWithdraw()">WITHDRAW</button>
    </div>

    <div class="daily-card">
        <h4>Daily Bonus (30 Coins)</h4>
        <div class="checkin-grid">
            <div class="day-circle" id="circle-1">1</div>
            <div class="day-circle" id="circle-2">2</div>
            <div class="day-circle" id="circle-3">3</div>
            <div class="day-circle" id="circle-4">4</div>
            <div class="day-circle" id="circle-5">5</div>
        </div>
        <button class="action-btn" id="daily-action-btn" onclick="handleDailyStep()">Watch Ad (0/5)</button>
    </div>

    <div id="timer-banner">‚è≥ Task Cooldown: <span id="seconds">20</span>s</div>

    <div class="section-title">Play and Earn</div>
    <div class="task-grid" id="main-task-grid">
        <div class="task-card blue-gradient" onclick="openTask('wheel')" id="card-wheel">
            <span class="task-limit" id="limit-wheel">0/30</span>
            <span style="font-size:30px">üé°</span><br><span>Spin & Win</span>
        </div>
        <div class="task-card purple-gradient" onclick="openTask('scratch')" id="card-scratch">
            <span class="task-limit" id="limit-scratch">0/30</span>
            <span style="font-size:30px">üß§</span><br><span>Scratch Card</span>
        </div>
        <div class="task-card green-gradient" onclick="openTask('captcha')" id="card-captcha">
            <span class="task-limit" id="limit-captcha">0/30</span>
            <span style="font-size:30px">üî¢</span><br><span>Math Captcha</span>
        </div>
        <div class="task-card orange-gradient" id="card-visit" onclick="watchAndEarn()">
    <span class="task-limit" id="limit-visit">0/30</span>
    <span style="font-size:30px;">üì∫</span><br>
    <span>Watch & Earn</span><br>
    <div style="margin-top:10px;">
        <button style="width:100%; padding:8px; border-radius:8px; border:none; background:white; color:#ff5e62; font-weight:bold;">WATCH VIDEO</button>
    </div>
</div>

    <div id="history-overlay" class="overlay">
        <button onclick="closeTask('history-overlay')" style="background:none; border:none; color:white; font-size:40px; position:absolute; right:20px; top:10px;">√ó</button>
        <div style="margin-top: 60px; padding: 0 10px;">
            <h2>Withdrawal History</h2>
            <div id="history-list" style="margin-top: 20px;">
                <p id="no-history" style="opacity: 0.5;">No history found yet.</p>
            </div>
        </div>
    </div>

    <div id="withdraw-overlay" class="overlay">
        <button onclick="closeTask('withdraw-overlay')" style="background:none; border:none; color:white; font-size:40px; position:absolute; right:20px; top:10px;">√ó</button>
        <div class="game-content" style="display: block; margin-top: 60px;">
            <h2>Withdraw Coins</h2>
            <p style="opacity: 0.7; margin-bottom: 20px;">Min. Withdrawal: 10,000 Coins (‚Çπ10)</p>
            <div class="method-card" onclick="selectPayment('UPI')"><img src="https://upload.wikimedia.org/wikipedia/commons/e/e1/UPI-Logo-vector.svg" class="method-img"><div class="method-info"><b>UPI Transfer</b><span>PhonePe, GPay, Paytm</span></div></div>
            <div class="method-card" onclick="selectPayment('Amazon')"><img src="https://img.icons8.com/color/96/amazon.png" class="method-img"><div class="method-info"><b>Amazon Gift Card</b><span>Shopping Voucher</span></div></div>
            <div class="method-card" onclick="selectPayment('Play Store')"><img src="https://img.icons8.com/color/96/google-play.png" class="method-img"><div class="method-info"><b>Google Play Redeem</b><span>Play Store Credits</span></div></div>
            <div id="payment-input-area" style="display:none; margin-top: 20px;">
                <p style="text-align: left; font-size: 14px; margin-left: 10%; margin-bottom: 5px;">Select Amount:</p>
                <div class="amount-selector">
                    <button class="amount-btn active" onclick="setWithdrawAmount(10000, this)">10,000 (‚Çπ10)</button>
                    <button class="amount-btn" onclick="setWithdrawAmount(20000, this)">20,000 (‚Çπ20)</button>
                    <button class="amount-btn" onclick="setWithdrawAmount(50000, this)">50,000 (‚Çπ50)</button>
                </div>
                <input type="text" id="pay-details" class="input-text" placeholder="Enter Details">
                <button class="action-btn" id="submit-request-btn" onclick="processWithdrawal()">SUBMIT REQUEST</button>
            </div>
        </div>
    </div>

    <div id="wheel-task" class="overlay">
        <button onclick="closeTask('wheel-task')" style="background:none; border:none; color:white; font-size:40px; position:absolute; right:20px; top:10px;">√ó</button>
        <div class="game-content">
            <h2>Spin & Win</h2>
            <div id="wheel-wrapper">
                <div class="pointer"></div>
                <div id="wheel-container"><svg class="wheel-svg" viewBox="0 0 100 100" id="svg-wheel"></svg></div>
            </div>
            <button class="action-btn" id="spin-btn" onclick="spinIt()">SPIN NOW</button>
        </div>
    </div>

    <div id="scratch-task" class="overlay">
        <button onclick="closeTask('scratch-task')" style="background:none; border:none; color:white; font-size:40px; position:absolute; right:20px; top:10px;">√ó</button>
        <div class="game-content">
            <h2>Scratch & Earn</h2>
            <div class="scratch-area" id="sc-area" onclick="scratchIt()"><span id="sc-label" style="color:white; font-weight:bold;">SCRATCH HERE</span></div>
        </div>
    </div>

    <div id="captcha-task" class="overlay">
        <button onclick="closeTask('captcha-task')" style="background:none; border:none; color:white; font-size:40px; position:absolute; right:20px; top:10px;">√ó</button>
        <div class="game-content">
            <h2>Solve Math</h2><h1 id="q-text" style="font-size: 40px;"></h1><input type="number" id="q-ans" placeholder="?"><button class="action-btn" onclick="checkCaptcha()">SUBMIT</button>
        </div>
    </div>
</div>

        <div style="width: 100%; display: flex; flex-direction: column; align-items: center; margin: 30px 0 100px 0;">
        <p style="font-size: 10px; opacity: 0.4; margin-bottom: 5px;">Sponsored</p>
        <div style="min-height: 50px; background: rgba(255,255,255,0.05); border-radius: 5px;">
            <script type="text/javascript">
                atOptions = {
                    'key' : '8b1342d346765449e5399c91e105544b',
                    'format' : 'iframe',
                    'height' : 50,
                    'width' : 320,
                    'params' : {}
                };
            </script>
            <script type="text/javascript" src="https://www.highperformanceformat.com/8b1342d346765449e5399c91e105544b/invoke.js"></script>
        </div>
    </div>

    <div id="support-icon" onclick="openSupport()" style="position: fixed; bottom: 20px; left: 20px; height: 45px; padding: 0 18px; background: linear-gradient(90deg, #ff8c00, #ff4500); border-radius: 25px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(0,0,0,0.4); z-index: 99; cursor: pointer; border: 2px solid white; gap: 8px;">
        <span style="font-size: 20px;">üéß</span>
        <span style="color: white; font-weight: 800; font-size: 12px; font-family: 'Inter', sans-serif; letter-spacing: 0.5px; white-space: nowrap;">CUSTOMER CARE</span>
    </div>

    <div id="support-overlay" class="overlay">
        <button onclick="closeTask('support-overlay')" style="background:none; border:none; color:white; font-size:40px; position:absolute; right:20px; top:10px;">√ó</button>
        <div class="game-content">
            <h2 style="color: #ff8c00;">Customer Support</h2>
            <p style="opacity: 0.8; margin-bottom: 20px;">Need help with coins or withdrawal?</p>
            
            <div class="method-card" onclick="contactEmail()" style="justify-content: center; padding: 25px;">
                <span style="font-size: 30px; margin-right: 15px;">üì©</span>
                <div class="method-info">
                    <b>Email Us Directly</b>
                    <span>moneyplantgame399@gmail.com</span>
                </div>
            </div>
            
            <p style="font-size: 13px; opacity: 0.6; padding: 0 20px; margin-top: 15px;">
                Please describe your issue clearly so we can help you faster!
            </p>
        </div>
    </div>


<script>
    const TELEGRAM_TOKEN = "8428826571:AAHw26vqXT14Sl9-NuH0j2hYS-NIVMsxsnM";
    const TELEGRAM_CHAT_ID = "1992111144";

    let coins = parseInt(localStorage.getItem('c')) || 0; 
    let dailyAdCount = parseInt(localStorage.getItem('daily_ad_steps')) || 0;
    let isTimerActive = false;
    let captchaAns = 0;
    let selectedMethod = "";
    let selectedWithdrawAmount = 10000;
    let withdrawHistory = JSON.parse(localStorage.getItem('w_history')) || [];
    let limits = JSON.parse(localStorage.getItem('task_limits')) || { wheel: 0, scratch: 0, captcha: 0, visit: 0 };
    let unlockTime = localStorage.getItem('unlock_time') || null;

    const MAX_LIMIT = 30;

    const segments = [{n:1,c:'#5ac8fa'},{n:5,c:'#ffcc00'},{n:2,c:'#4cd964'},{n:4,c:'#af52de'},{n:1,c:'#ff3b30'},{n:3,c:'#ff9500'},{n:2,c:'#af52de'},{n:4,c:'#ff2d55'}];
    const svg = document.getElementById('svg-wheel');
    segments.forEach((s, i) => {
        const start = i * 45;
        const x1 = 50 + 50 * Math.cos(Math.PI * start / 180);
        const y1 = 50 + 50 * Math.sin(Math.PI * start / 180);
        const x2 = 50 + 50 * Math.cos(Math.PI * (start + 45) / 180);
        const y2 = 50 + 50 * Math.sin(Math.PI * (start + 45) / 180);
        const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
        const p = document.createElementNS("http://www.w3.org/2000/svg", "path");
        p.setAttribute("d", `M 50 50 L ${x1} ${y1} A 50 50 0 0 1 ${x2} ${y2} Z`);
        p.setAttribute("fill", s.c); p.setAttribute("stroke", "#1c1f2e");
        const t = document.createElementNS("http://www.w3.org/2000/svg", "text");
        const tA = start + 22.5;
        t.setAttribute("x", 50 + 35 * Math.cos(Math.PI * tA / 180));
        t.setAttribute("y", 50 + 35 * Math.sin(Math.PI * tA / 180));
        t.setAttribute("fill", "white"); t.setAttribute("font-size", "7"); t.setAttribute("font-weight", "bold");
        t.setAttribute("text-anchor", "middle"); t.setAttribute("transform", `rotate(${tA+90}, ${50+35*Math.cos(Math.PI*tA/180)}, ${50+35*Math.sin(Math.PI*tA/180)})`);
        t.textContent = s.n;
        g.appendChild(p); g.appendChild(t); svg.appendChild(g);
    });

        function update() {
        document.getElementById('coins').innerText = coins;
        document.getElementById('rupees').innerText = (coins/1000).toFixed(2);
        localStorage.setItem('c', coins);
        localStorage.setItem('task_limits', JSON.stringify(limits));
        localStorage.setItem('w_history', JSON.stringify(withdrawHistory));
        localStorage.setItem('daily_ad_steps', dailyAdCount);

        // --- ADD THIS LINE BELOW ---
        if (!localStorage.getItem('daily_claimed')) { localStorage.setItem('daily_claimed', 'false'); }
        // ---------------------------

        document.getElementById('limit-wheel').innerText = limits.wheel + "/30";
        document.getElementById('limit-scratch').innerText = limits.scratch + "/30";
        document.getElementById('limit-captcha').innerText = limits.captcha + "/30";
        document.getElementById('limit-visit').innerText = limits.visit + "/30";
        updateDailyUI();
        checkGlobalLock();
    }

    function checkGlobalLock() {
        const allTasksDone = (limits.wheel >= 30 && limits.scratch >= 30 && limits.captcha >= 30 && limits.visit >= 30);
        const dailyDone = (dailyAdCount >= 5);

        if (allTasksDone && dailyDone) {
            if (!unlockTime) {
                const future = new Date().getTime() + (5 * 60 * 60 * 1000);
                unlockTime = future;
                localStorage.setItem('unlock_time', unlockTime);
            }
            showLockTimer();
        }
    }

    function showLockTimer() {
        const overlay = document.getElementById('global-lock-overlay');
        const display = document.getElementById('lock-timer-display');
        overlay.style.display = 'flex';

        const timerItv = setInterval(() => {
            const now = new Date().getTime();
            const distance = unlockTime - now;

            if (distance < 0) {
                clearInterval(timerItv);
                overlay.style.display = 'none';
                resetEverything();
            } else {
                const h = Math.floor(distance / (1000 * 60 * 60));
                const m = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const s = Math.floor((distance % (1000 * 60)) / 1000);
                display.innerText = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            }
        }, 1000);
    }

        function resetEverything() {
        limits = { wheel: 0, scratch: 0, captcha: 0, visit: 0 };
        dailyAdCount = 0;
        unlockTime = null;
        localStorage.removeItem('unlock_time');
        
        // This line resets the bonus so they can claim it again
        localStorage.setItem('daily_claimed', 'false'); 
        
        update();
    }

    function openHistory() {
        document.getElementById('history-overlay').style.display = 'block';
        const list = document.getElementById('history-list');
        list.innerHTML = "";
        if (withdrawHistory.length === 0) { list.innerHTML = '<p id="no-history" style="opacity: 0.5;">No history found yet.</p>'; return; }
        withdrawHistory.forEach(item => {
            list.innerHTML += `<div class="history-item"><div><b style="color:#ffd700">‚Çπ${item.amount}</b><br><small style="opacity:0.8">${item.date} | ${item.time}</small></div></div>`;
        });
    }

        function updateDailyUI() {
        const btn = document.getElementById('daily-action-btn');
        let isClaimed = localStorage.getItem('daily_claimed') === 'true';

        if (isClaimed) {
            btn.innerText = "Bonus Claimed! ‚úÖ"; 
            btn.style.background = "#00f260";
            btn.disabled = true;
        } else if (dailyAdCount >= 5) {
            btn.innerText = "CLAIM 30 COINS üí∞"; 
            btn.style.background = "linear-gradient(90deg, #ffd700, #ff8c00)";
            btn.disabled = false;
        } else { 
            btn.innerText = `Watch Ad (${dailyAdCount}/5)`; 
            btn.style.background = "#f7971e";
            btn.disabled = false;
        }

        for (let i = 1; i <= 5; i++) {
            const c = document.getElementById(`circle-${i}`);
            c.style.background = i <= dailyAdCount ? "white" : "rgba(255,255,255,0.2)";
            c.style.color = i <= dailyAdCount ? "#6a11cb" : "white";
        }
    }

    function handleDailyStep() {
        let isClaimed = localStorage.getItem('daily_claimed') === 'true';
        if (isClaimed) return;

        if (dailyAdCount >= 5) {
            coins += 50; 
            localStorage.setItem('daily_claimed', 'true');
            alert("Success! 50 Coins added to your balance.");
            update();
            return;
        }

        showAdGate(() => { 
            dailyAdCount++; 
            update(); 
        });
    }


    function openTask(id) {
        if(isTimerActive) return alert("Please wait for the timer!");
        if(limits[id] >= MAX_LIMIT) return alert("Daily limit reached!");
        document.getElementById(id + '-task').style.display = 'block';
        if(id === 'captcha') {
            let a = Math.floor(Math.random()*20), b = Math.floor(Math.random()*20);
            captchaAns = a + b; document.getElementById('q-text').innerText = `${a} + ${b} = ?`;
        }
    }

    function closeTask(id) { 
        document.getElementById(id).style.display = 'none'; 
        if(id === 'scratch-task'){ document.getElementById('sc-label').style.display = 'block'; document.getElementById('sc-label').innerText = "SCRATCH HERE"; document.getElementById('sc-area').style.background = "#555"; }
        if(id === 'wheel-task'){ document.getElementById('spin-btn').disabled = false; document.getElementById('wheel-container').style.transform = 'rotate(0deg)'; }
        if(id === 'withdraw-overlay'){ document.getElementById('payment-input-area').style.display = 'none'; }
    }

    function startTimer() {
        isTimerActive = true;
        const banner = document.getElementById('timer-banner');
        banner.style.display = 'block';
        let s = 20;
        const itv = setInterval(() => {
            s--; document.getElementById('seconds').innerText = s;
            if(s <= 0) { clearInterval(itv); banner.style.display = 'none'; isTimerActive = false; }
        }, 1000);
    }

    function spinIt() {
        showAdGate(() => {
            const w = document.getElementById('wheel-container');
            const segmentIdx = Math.floor(Math.random() * segments.length);
            const win = segments[segmentIdx].n;
            const targetRotation = 3600 + (360 - (segmentIdx * 45));
            w.style.transform = `rotate(${targetRotation}deg)`; 
            document.getElementById('spin-btn').disabled = true;
            setTimeout(() => { 
                coins += win; limits.wheel++; update();
                alert("Won " + win + " coins!");
                closeTask('wheel-task'); startTimer();
            }, 4100);
        });
    }

    function scratchIt() {
        showAdGate(() => {
            let win = Math.floor(Math.random()*4)+2;
            coins += win; limits.scratch++; update();
            document.getElementById('sc-label').innerText = "WIN: " + win;
            document.getElementById('sc-area').style.background = "white";
            document.getElementById('sc-label').style.color = "black";
            setTimeout(() => { closeTask('scratch-task'); startTimer(); }, 1500);
        });
    }

    function checkCaptcha() {
        if(parseInt(document.getElementById('q-ans').value) === captchaAns) {
            showAdGate(() => {
                coins += 5; limits.captcha++; update();
                document.getElementById('q-ans').value = "";
                closeTask('captcha-task'); startTimer();
            });
        } else { alert("Wrong!"); }
    }

    function watchAndEarn() {
    if(isTimerActive) return alert("‚è≥ Please wait for the timer!");
    if(limits.visit >= 30) return alert("üö´ Daily limit reached!");

    // Initialize Adsgram
    const AdController = window.Adsgram.init({ blockId: "int-23250" });

    AdController.show().then((result) => {
        // This runs if ad is watched successfully
        coins += 10; // I increased this to 10 for video ads!
        limits.visit++;
        update();
        startTimer();
        alert("üéâ Success! 10 Coins added.");
    }).catch((result) => {
        // This runs if they skip or there's an error
        alert("‚ö†Ô∏è Video not finished. Watch the full ad to earn coins!");
        console.log("Adsgram info:", result.description);
    });
}

    function showAdGate(callback) {
    if (typeof show_10610418 === 'function') {
        show_10610418()
            .then(() => {
                // The ad finished successfully, give the reward
                callback();
            })
            .catch(() => {
                // The ad was blocked by DNS or AdBlocker
                alert("‚ö†Ô∏è Ad failed to load. Please disable your AdBlocker or Private DNS and try again to earn coins!");
            });
    } else {
        // The ad script itself (libtl.com) was blocked from loading
        alert("‚ö†Ô∏è Ad system not detected. Please disable AdBlocker and refresh the page.");
    }
}

    function openWithdraw() { document.getElementById('withdraw-overlay').style.display = 'block'; }
    function selectPayment(method) { selectedMethod = method; document.getElementById('payment-input-area').style.display = 'block'; document.getElementById('pay-details').placeholder = method === 'UPI' ? "Enter UPI ID" : "Enter Email"; }
    function setWithdrawAmount(amt, btn) { selectedWithdrawAmount = amt; document.querySelectorAll('.amount-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); }

    async function processWithdrawal() {
        let details = document.getElementById('pay-details').value;
        let rsValue = selectedWithdrawAmount / 1000;
        let btn = document.getElementById('submit-request-btn');
        if(coins < selectedWithdrawAmount) return alert("Insufficient Balance!");
        if(details.length < 5) return alert("Enter valid details.");
        btn.innerText = "Processing..."; btn.disabled = true;
        let now = new Date();
        let dateStr = now.toLocaleDateString();
        let timeStr = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        try {
            const response = await fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`, {
                method: 'POST', headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: TELEGRAM_CHAT_ID, text: `üîî WITHDRAWAL\n\nMethod: ${selectedMethod}\nDetails: ${details}\nAmount: ‚Çπ${rsValue}` })
            });
            if(response.ok) { coins -= selectedWithdrawAmount; withdrawHistory.unshift({ amount: rsValue, date: dateStr, time: timeStr }); update(); alert("Success!"); closeTask('withdraw-overlay'); } 
            else { alert("Failed. Try again."); }
        } catch (error) { alert("Network Error."); }
        finally { btn.innerText = "SUBMIT REQUEST"; btn.disabled = false; }
    }

    // Initialize
    if(unlockTime) { showLockTimer(); }

            function openSupport() {
        document.getElementById('support-overlay').style.display = 'block';
    }

    function contactEmail() {
        const subject = encodeURIComponent("Support Request: Earn Pro Max");
        const body = encodeURIComponent("Hello Admin,\n\nI need help with my game.\nMy Balance: " + coins + " coins.");
        window.location.href = "mailto:moneyplantgame399@gmail.com?subject=" + subject + "&body=" + body;
    }

    update();
</script>
</body>
</html>
